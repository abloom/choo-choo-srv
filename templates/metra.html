<html>
    <head>
        <title>Metra Tracker</title>
        <style>
            {% for route_id, route in routes.items() %}
            .route-{{ route_id }}::before {
                color: #{{ route["route_color"] }};
                content: "\2588"
            }
            {% endfor %}

            .trip-data .arrival-time::before,
            .route .short-name::after {
                content: "\2013";
            }

            .trip-data {
                margin-top: 0.25em;
            }

            .route {
                padding: 0.25em 1em;
                border-right: 1px solid lightgray;
            }

            .route:last-child {
                border-right: none;
            }

            .route-container {
                display: flex;
                font-size: 250%;
            }

            .route .trip-data li {
                white-space: nowrap;
            }
        </style>
    </head>
    <body>
        <div class="route-container">
        {% for trip_update in trip_updates %}
            {% set route = routes[trip_update["trip_update"]["trip"]["route_id"]] %}
            {% set trip = trips[trip_update["trip_update"]["trip"]["trip_id"]] %}
            <div class="route" data-route-id="{{ route['route_id'] }}">
                <span class="route-{{ route['route_id'] }}">
                    <span class="short-name">
                        {{ route["route_short_name"] }}
                    </span>    
                    <span clas="direction">
                        {{ directions[trip["direction_id"]] }}
                    </span>
                </span>
                <ul class="trip-data">
                {% for stop_update in trip_update["trip_update"]["stop_time_update"] %}
                    {% set stop = stops[stop_update["stop_id"]] %}
                    <li>
                        <span class="stop" data-stop-id="{{ stop['stop_id'] }}">{{ stop["stop_name"] }}</span>
                        {% if stop_update["arrival"] %}
                        <span class="arrival-time">{{ stop_update["arrival"]["time"]["low"]|from_iso_to_datetime|to_local_time }}</span>
                        {% endif %}
                    </li>
                {% endfor %}
                </ul>
            </div>
        {% endfor %}
        </div>

        <script type="text/javascript">
            const x = setTimeout(function() { location.reload(); }, 15000);
        </script>
    </body>
</html>